<div *ngIf="selectedDataset$ | async as dataset">
  <div *ngIf="dataset.accessRights">
    <div class="container">
      <gpf-genes-block></gpf-genes-block>
      <gpf-regions-block></gpf-regions-block>
      <gpf-genotype-block></gpf-genotype-block>
      <gpf-study-filters-block
        *ngIf="dataset?.genotypeBrowserConfig?.hasStudyFilters"
        [dataset]="dataset">
      </gpf-study-filters-block>
      <gpf-genomic-scores-block>
      </gpf-genomic-scores-block>
      <gpf-family-filters-block
        *ngIf="dataset?.genotypeBrowserConfig?.hasFamilyFilters"
        [dataset]="dataset"
        [genotypeBrowserState]="genotypeBrowserState">
      </gpf-family-filters-block>

      <div class="form-block">
    	  <form
    	      (ngSubmit)="onSubmit($event)"
            action="{{ configService.baseUrl }}genotype_browser/download" method="post">
    	    <input name="queryData" type="hidden">
    	    <button class="btn btn-md btn-primary btn-right" id="download-button" type="submit">Download</button>
        </form>
        <div class="button">
          <input type="button" class="btn btn-md btn-primary" id="table-preview-button" value="Table Preview" (click)="tablePreview = true; submitQuery()">
          <input *ngIf="dataset?.genotypeBrowserConfig?.hasGraphicalPreview"
            type="button" class="btn btn-md btn-primary"
            value="Graphical Preview"
            (click)="tablePreview = false; submitQuery()">
          <gpf-save-query-button queryType="genotype"></gpf-save-query-button>
        </div>
      </div>
    </div>
    <div class="genotype-browser-results" *ngIf="genotypePreviewVariantsArray">
      
      <p class="overview">
        <span *ngIf="!loadingFinished">
          <span class="loader"></span>
          Loading variants...
        </span>
        <span *ngIf="loadingFinished" id="variants-count-span">
          {{ genotypePreviewVariantsArray.variantsCount }}
        </span>
      </p>

      <gpf-genotype-preview-table
      	*ngIf="tablePreview"
        [columns]="dataset?.genotypeBrowserConfig?.columns"
        [genotypePreviewInfo]="genotypePreviewInfo"
        [genotypePreviewVariantsArray]="genotypePreviewVariantsArray">
      </gpf-genotype-preview-table>
      <gpf-genotype-preview-chromosomes
        class="chromosomes-preview"
        *ngIf="tablePreview === false"
        width="1110"
        [genotypePreviews]="genotypePreviewVariantsArray?.genotypePreviews">
      </gpf-genotype-preview-chromosomes>
    </div>
  </div>
</div>
