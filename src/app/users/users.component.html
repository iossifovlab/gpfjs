<div *ngIf="(userInfo$ | async)?.email as email" class="row justify-content-end dropdown">
  <div class="align-self-center">
    <span class="username-field">{{ email }}</span>
    <button class="btn btn-sm" id="logout-button" (click)="logout()">Logout</button>
  </div>
</div>

<div *ngIf="!(userInfo$ | async)?.email" class="row justify-content-end dropdown" data-backdrop="static">
  <div>
    <button
      #dropdownButton
      (click)="hideDropdown = !hideDropdown; focusEmailInput()"
      class="btn btn-secondary dropdown-toggle"
      id="login-dropdown-toggle-button"
      type="button"
      [disabled]="loading">
      <span>Login</span>
    </button>
    <div #dialog id="login-window" class="open row" [hidden]="hideDropdown">
      <form>
        <div class="row">
          <div class="col-12">
            <div class="form-group">
              <label for="username">Email</label>
              <input
                #emailInput
                name="username"
                id="username"
                class="form-control"
                [(ngModel)]="username"
                [ngClass]="{ 'submitted-email-input': showPasswordField }"
                type="text"
                (focus)="back()" />
            </div>
          </div>
          <div *ngIf="!showPasswordField" class="col-12">
            <button
              class="btn btn-primary"
              id="next-button"
              style="width: 100%"
              (click)="next(); focusPasswordInput()"
              >Next</button
            >
          </div>
        </div>

        <div *ngIf="showPasswordField" class="row mt-1">
          <div class="col-12">
            <div class="form-group">
              <label for="password">Password</label>
              <input
                #passwordInput
                name="password"
                id="password"
                class="form-control"
                [(ngModel)]="password"
                type="password"
                autocomplete="off" />
            </div>
          </div>
          <div class="col-12">
            <button
              type="submit"
              class="btn btn-primary"
              id="login-button"
              style="width: 100%"
              (click)="login()"
              [class.spinner]="passwordTimeout"
              [disabled]="passwordTimeout">
              <span>Login</span>
            </button>
          </div>
        </div>

        <div class="row mt-1 justify-content-center">
          <div>
            <button class="btn btn-sm btn-link" (click)="showRegister()">Register</button>
            <button class="btn btn-sm btn-link" (click)="showForgotPassword()">Forgotten password</button>
          </div>
        </div>
        <div *ngIf="errorMessage" class="row mt-1">
          <div class="col-12">
            <div class="alert alert-danger" style="text-align: center; margin-bottom: 0">{{ errorMessage }}</div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
