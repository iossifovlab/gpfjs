<div class="row">
  <div class="col-12 mt-3">
    <gpf-table noScrollOptimization="true" [dataSource]="tableData$ | async" style="display: inline-block; width: 100%">
      <gpf-table-column>
        <gpf-table-header caption="Dataset" field="dataset"></gpf-table-header>
        <gpf-table-content>
          <gpf-table-subcontent>
            <span *gpfTableCellContent="let data">
              {{ data.dataset.name || data.dataset.id }}
            </span>
          </gpf-table-subcontent>
        </gpf-table-content>
      </gpf-table-column>
      <gpf-table-column>
        <gpf-table-header caption="Groups with access"></gpf-table-header>
        <gpf-table-content>
          <gpf-table-subcontent>
            <span *gpfTableCellContent="let data">
              <div *ngFor="let group of data.groups">
                {{ group }}
                <gpf-small-remove-button
                  (clicked)="removeGroup(data.dataset, group)"
                  [hide]="!isDefaultGroup(data.dataset, group)"
                  message="Removing the group '{{ group }}' could change which users have access to the dataset {{ data.dataset.id }}."
                  confirmText="Remove group"
                  title="Remove group">
                </gpf-small-remove-button>
              </div>
              <input [ngbTypeahead]="searchGroups(data.groups)"
                (selectItem)="updatePermissions(data.dataset, $event.item)" />
            </span>
          </gpf-table-subcontent>
        </gpf-table-content>
      </gpf-table-column>
      <gpf-table-column>
        <gpf-table-header caption="Users with access"></gpf-table-header>
        <gpf-table-content>
          <gpf-table-subcontent>
            <span *gpfTableCellContent="let data">
              <div *ngFor="let user of data.users">
                {{ user.email }}
              </div>
            </span>
          </gpf-table-subcontent>
        </gpf-table-content>
      </gpf-table-column>
    </gpf-table>
  </div>
</div>
