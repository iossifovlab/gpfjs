<div style="padding: 25px; padding-top: 16px;">
  <div id="above-table-bar">
    <div class="above-table-bar-item" style="width: 440px">
      <div class="search-input-wrapper">
        <input
          #searchBox
          (keyup)="searchKeystrokes$.next(searchBox.value)"
          id="gene-search-input"
          class="search-input form-control"
          autocomplete="off"
          placeholder="Search"
          type="text" />
        <span
          *ngIf="searchBox.value !== ''"
          class="clear-search-icon"
          (click)="searchBox.value = ''; search(searchBox.value)">
        </span>
      </div>
    </div>

    <div class="above-table-bar-item">
      <button
        #columnFilteringButton
        id="category-filtering-button"
        class="btn btn-default"
        (click)="openCategoryFilterDropdown($event)"
        >Categories filter</button
      >
    </div>

    <div id="keybinds-icon" class="above-table-bar-item" (mouseover)="showKeybinds = true" (mouseout)="showKeybinds = false">
      <span>?</span>
    </div>

    <div *ngIf="showKeybinds" class="keybinds-tooltip">
      <span>1</span>&#160;<span>2</span>&#160;<span>3</span> - navigate to tab by index<br />
      <span>e</span> or <span>n</span> - navigate to the next tab<br />
      <span>q</span> or <span>p</span> - navigate to the previous tab<br />
      <span>w</span> - close current tab<br />
      <span>middleclick</span> or <span>ctrl</span>/<span>command</span> + <span>click</span> - highlight row<br />
      <span>esc</span> - clear all highlights<br />
      <span>f</span> - compare highlighted genes<br />
    </div>
  </div>

  <div *ngIf="config" class="table-container">
    <div class="header table-row">
      <ng-container *ngTemplateOutlet="tableHeaderTemplate; context: { columns: config.columns }"></ng-container>
    </div>
    <div id="table-body">
      <div *ngFor="let row of genes; let i = index"
        class="table-row table-body-row"
        [ngClass]="{'row-highlight': highlightedGenes.has(row[geneSymbolColumnId])}">
        <ng-container *ngIf="shownRows.indexOf(i) !== -1">
          <span *ngFor="let column of leaves"
            class="cell row-cell"
            [ngClass]="{'clickable': column.clickable !== null && row[column.id]}"
            [attr.title]="row[column.id]"
            (click)="handleCellClick($event, row, column)"
            (middleclick)="handleCellClick($event, row, column)"
            >{{ row[column.id] }}</span
          >
        </ng-container>
      </div>
    </div>

    <div id="nothing-found" *ngIf="showNothingFound">
      <span>Nothing found</span>
    </div>

    <div id="loading" *ngIf="showLoading">
      <span>Loading...</span>
    </div>
  </div>

  <ng-template #tableHeaderTemplate let-columns="columns">
    <ng-container *ngFor="let column of columns">
      <ng-container *ngIf="column.visibility">
        <div class="cell header-cell {{'column-depth-' + column.depth}}"
          [ngClass]="{'active-sort-header': column.id === sortingHeaderId}"
          [style.grid-column]="column.gridColumn"
          [style.grid-row]="column.gridRow"
          [style.cursor]="column.sortable ? 'pointer' : 'default'"
          (click)="column.sortable && sort(column.id, orderBy === 'desc' ? 'asc' : 'desc')"
        >
          <div class="header-cell-content"
            [ngClass]="{'header-cell-vertical-content': column.displayVertical}"
          >
            <span
              class="header-cell-content-span"
              [attr.title]="column.meta || column.displayName"
              [ngClass]="{'vertical-text': column.displayVertical, 'header-gene-symbol-span' : column.id === geneSymbolColumnId}"
              >{{ column.displayName | truncate : 48 }}</span
            >
            <gpf-sorting-buttons
              *ngIf="column.sortable"
              [id]="column.id"
              class="header-button"
              style="pointer-events: none"
            >
            </gpf-sorting-buttons>
            <button
              *ngIf="column.columns.length"
              #columnFilteringButton
              class="header-button navbar-toggler column-filtering-button"
              (click)="openDropdown(column, $event)">
              &#9776;
            </button>
          </div>
        </div>
        <ng-container *ngTemplateOutlet="tableHeaderTemplate; context: { columns: column.columns }"></ng-container>
      </ng-container>
    </ng-container>
  </ng-template>

  <span #dropdownSpan class="dropdown-span" ngbDropdown [style.top.px]="modalPosition.top" [style.left.px]="modalPosition.left">
    <button ngbDropdownToggle style="display: none"></button>
    <gpf-multiple-select-menu class="multiple-select-menu" ngbDropdownMenu (applyEvent)="calculateHeaderLayout()" (reorderEvent)="reorderHeader($event)">
    </gpf-multiple-select-menu>
  </span>

  <div id="compare-genes-modal" *ngIf="highlightedGenes.size >= 1">
    <div *ngFor="let gene of highlightedGenes"
      class="btn-group"
      style="margin: 4px; background-color: none"
      role="group">
      <button [attr.title]="gene" type="button" style="border: 1px solid #ddd; padding-right: 0; width: 145px; background: none">
        <span (middleclick)="emitCreateTabEvent($event, gene, false)" (click)="emitCreateTabEvent($event, gene)" class="compare-genes-gene-name clickable">{{ gene }}</span>
        <button (click)="toggleHighlightGene(gene)" class="compare-genes-close font-weight-light" type="button">Ã—</button>
      </button>
    </div>

    <br>

    <button
      id="compare-genes-compare-button"
      class="btn btn-default"
      (click)="emitCreateTabEvent()">Compare</button
    >
  </div>
</div>
