<ng-template #pedigree>
  <div class="toggle-maximize" (click)="toggleMaximize()"></div>
  <div
    #wrapper
    class="svg-wrapper clickable"
    style="display: flex; width: 100%; height: 100%"
    data-toggle="modal"
    data-target="#pedigreeModal">
    <svg [attr.width]="width" [attr.viewBox]="getViewBox()" [ngClass]="{ 'fullscreen-pedigree': maximized }">
      <svg:line
        *ngFor="let straightLine of straightLines"
        [attr.x1]="straightLine.startX"
        [attr.y1]="straightLine.startY"
        [attr.x2]="straightLine.endX"
        [attr.y2]="straightLine.endY"
        stroke="black"
        stroke-width="1" />

      <svg:path
        *ngFor="let curveLine of curveLines"
        [attr.d]="curveLine.path"
        fill="none"
        stroke="black"
        stroke-width="1" />

      <svg:g
        gpf-pedigree-chart-member
        *ngFor="let pedigree of pedigreeDataWithLayout"
        [attr.transform]="
          'translate(' +
          pedigree.xUpperLeftCorner +
          ' ' +
          pedigree.yUpperLeftCorner +
          ') scale(' +
          pedigree.scaleFactor +
          ')'
        "
        [pedigreeData]="pedigree.individual.pedigreeData" />
    </svg>
  </div>
</ng-template>

<div class="modal fade" id="pedigreeModal">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div style="padding: 5px;" class="modal-content">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span style="float: right; margin-right: 10px" aria-hidden="true">&times;</span>
      </button>
      <div class="modal-body">
        <ng-container *ngTemplateOutlet="pedigree"></ng-container>
      </div>
      <ngb-accordion class="modalAccordion" #a="ngbAccordion">
        <ngb-panel>
          <ng-template ngbPanelHeader>
            <div style="display: flex; border: 1px solid grey;">
              <button type="button" class="accordion-button btn" ngbPanelToggle style="width: 100%; text-align: left;">
                Default-looking "custom" panel
              </button>
              <button type="button" class="btn">Download</button>
            </div>
          </ng-template>
          <ng-template ngbPanelContent>
            <div class="familyPanel">
              <gpf-loading-spinner [loadingFinished]="false"></gpf-loading-spinner>
            </div>
          </ng-template>
        </ngb-panel>
      </ngb-accordion>
    </div>
  </div>
</div>

<div *ngIf="!maximized">
  <ng-container *ngTemplateOutlet="pedigree"></ng-container>
</div>

<!--REVIEW maximized may not be needed, modal-->
