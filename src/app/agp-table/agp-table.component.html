<div *ngIf="config" class="table-container">
  <div style="margin: 10px; margin-left: 0px">
    <span>Search genes:</span>
    <input
      #geneSearchInput
      (keyup)="searchKeystrokes$.next(geneSearchInput.value)"
      id="gene-search-input"
      style="width: 200px; margin-left: 10px"
      autocomplete="off"
      type="text" />
  </div>

  <div class="header row">
    <ng-container *ngTemplateOutlet="recursiveListTmpl; context: { columns: config.columns }"></ng-container>
  </div>

  <div class="row" *ngFor="let row of genes; let i = index" [attr.id]="'row-' + i" (click)="highlightRow(i)">
    <span class="cell" *ngFor="let column of leaves">{{ row[column.id] }}</span>
  </div>
</div>

<ng-template #recursiveListTmpl let-columns="columns">
  <ng-container *ngFor="let column of columns">
    <ng-container *ngIf="column.visibility">
      <div class="cell"
        style="overflow: hidden"
        [style.grid-column]="column.gridColumn"
        [style.grid-row]="column.gridRow"
      >
        <span class="header-cell">{{ column.displayName }}</span>
        <gpf-sorting-buttons
          *ngIf="column.sortable"
          [id]="column.id"
          (sortEvent)="sort($event.id, $event.order)"></gpf-sorting-buttons>
        <ng-container *ngIf="column.columns.length !== 0">
          <button
            #columnFilteringButton
            [attr.id]="column.id + '-column-filtering-button'"
            class="dropdown-toggle btn navbar-toggler"
            (click)="openDropdown(column)">
            &#9776;
          </button>
        </ng-container>
      </div>
      <ng-container *ngTemplateOutlet=" recursiveListTmpl; context: { columns: column.columns }"></ng-container>
    </ng-container>
  </ng-container>
</ng-template>

<span #dropdownSpan class="dropdown-span" ngbDropdown>
  <button ngbDropdownToggle style="display: none"></button>
  <!-- REFACTOR itemsSource -->
  <gpf-multiple-select-menu
    class="multiple-select-menu"
    ngbDropdownMenu
    (applyEvent)="filterColumns($event)"></gpf-multiple-select-menu>
</span>