<div *ngIf="config" class="table-container">
  <div style="display: flex; justify-content: space-between">
    <div class="input-group mb-3" style="width: 300px">
      <div class="input-group-prepend">
        <span class="input-group-text">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
          </svg>
        </span>
      </div>
      <input
        #geneSearchInput
        (keyup)="searchKeystrokes$.next(geneSearchInput.value)"
        class="form-control"
        autocomplete="off"
        placeholder="Search genes"
        type="text" />
    </div>
  </div>

  <div class="header table-row">
    <ng-container *ngTemplateOutlet="recursiveListTmpl; context: { columns: config.columns }"></ng-container>
  </div>
  
  <div class="table-row" *ngFor="let row of genes"
    [attr.id]="row[geneSymbolColumnId]"
    (click)="toggleHighlightGene(row[geneSymbolColumnId])"
    [ngClass]="{'row-highlight': highlightedGenes.has(row[geneSymbolColumnId])}">
    <span class="cell" *ngFor="let column of leaves"
    [ngClass]="{'clickable': column.clickable !== null && row[column.id]}"
    (middleclick)="emitClickEvent(row, column)">{{ row[column.id] }}</span>
  </div>
</div>

<ng-template #recursiveListTmpl let-columns="columns">
  <ng-container *ngFor="let column of columns">
    <ng-container *ngIf="column.visibility">
      <div class="cell"
        style="overflow: hidden"
        [style.grid-column]="column.gridColumn"
        [style.grid-row]="column.gridRow"
      >
        <div style="display: flex; justify-content: center; align-items: center; width: 100%"
          [ngStyle]="{'flex-direction': column.displayVertical ? 'column': 'row'}">
          <span class="header-cell"
          [ngClass]="{'vertical-text': column.displayVertical }">{{ column.displayName }}</span>
          <gpf-sorting-buttons
            *ngIf="column.sortable"
            [id]="column.id"
            (sortEvent)="sort($event.id, $event.order)"></gpf-sorting-buttons>
          <ng-container *ngIf="column.columns.length !== 0">
            <button
              #columnFilteringButton
              [attr.id]="column.id + '-column-filtering-button'"
              class="dropdown-toggle btn navbar-toggler"
              (click)="openDropdown(column)">
              &#9776;
            </button>
          </ng-container>
        </div>
      </div>
      <ng-container *ngTemplateOutlet=" recursiveListTmpl; context: { columns: column.columns }"></ng-container>
    </ng-container>
  </ng-container>
</ng-template>

<span #dropdownSpan class="dropdown-span" ngbDropdown>
  <button ngbDropdownToggle style="display: none"></button>
  <gpf-multiple-select-menu class="multiple-select-menu" ngbDropdownMenu (applyEvent)="calculateHeaderLayout()"></gpf-multiple-select-menu>
</span>

<div
  *ngIf="highlightedGenes.size > 0"
  id="highlighted-genes">
  <button *ngFor="let gene of highlightedGenes" class="btn btn-primary" style="margin: 2px" (click)="toggleHighlightGene(gene)">
    {{ gene }} <span class="badge text-light">X</span>
  </button>
  <br>
  <button class="btn btn-warning" style="margin: 2px" (click)="emitCreateTabEvent()">
    Compare
  </button>
</div>